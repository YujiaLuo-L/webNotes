<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <title>三维定位</title>
    <link
      rel="stylesheet"
      href="./Cesium-1.99/Build/Cesium/Widgets/widgets.css"
    />
  </head>

  <body>
    <div style="width: 100%; height: 100%">
      <div id="cesiumContainer" class="fullSize"></div>
      <div id="toolbar"></div>
    </div>
    <div class="buttom" style="position: fixed; font-size: 18px; top: 10px">
      <button id="viewerFlyTo">viewerFlyTo</button>
      <button id="CameraFlyTo">CameraFlyTo</button>
    </div>
  </body>
  <script src="./Cesium-1.99/Build/Cesium/Cesium.js"></script>

  <script type="text/javascript">
    const xmin = 106.61383056640625,
      xmax = 107.1439208984375,
      ymin = 35.8319091796875,
      ymax = 36.36474609375;
    // //调整跳转速度
    // // 飞到目的地
    const viewer = new Cesium.Viewer("cesiumContainer");
    let labelSource;
    //创建一个实体

    function creatEntity() {
      labelSource = new Cesium.CustomDataSource("labelSource");
      viewer.dataSources.add(labelSource);
      var list = [
        {
          id: 1,
          lng: 107.62,
          lat: 35.9,
        },
        {
          id: 2,
          lng: 107.82,
          lat: 35.98,
        },
        {
          id: 3,
          lng: 108.1,
          lat: 35.9,
        },
        {
          id: 4,
          lng: 107.9,
          lat: 36.3,
        },
        {
          id: 5,
          lng: 108.1,
          lat: 36,
        },
      ];
      list.forEach((item) => {
        if (!item.lng || !item.lat) return;
        const opts = {
          id: item.id, //根据需求定义，必须唯一，可以是数据库对应point的主键
          name: "自行定义", //不唯一
          position: Cesium.Cartesian3.fromDegrees(
            Number(item.lng),
            Number(item.lat)
          ),
          billboard: {
            image: "../img/circle_bule.png",
            // 处理图标被遮挡问题
            // disableDepthTestDistance:1000,//设置与相机的距离，以在该距离处禁用深度测试
            // heightReference: Cesium.HeightReference.NONE,//获取或设置此广告牌的高度参数
            // heightReference: Cesium.HeightReference.RELATIVE_TO_GROUND,//获取或设置此广告牌的高度参数
            heightReference: Cesium.HeightReference.CLAMP_TO_GROUND, //获取或设置此广告牌的高度参数
            horizontalOrigin: Cesium.HorizontalOrigin.CENTER, //获取或设置此广告排的水平原点，确定该广告牌是否为在其锚位置的左侧、中央或右侧
            verticalOrigin: Cesium.VerticalOrigin.BOTTOM, //获取或设置此广告牌的垂直原点，确定该广告牌是否为到其锚定位置的上方，下方或中心。
            scale: 1.0,
            // distanceDisplayCondition:new Cesium.DistanceDisplayCondition(0,10000) //设置条件，指定将在距离摄像机多远的距离显示图标
          },
          label: {
            text: "红红火火恍恍惚惚",
            // showBackground: true,
            font: "24px Helvetica",
            scale: 0.5,
            // backgroundColor: Cesium.Color.BLACK.withAlpha(0.3),
            horizontalOrigin: Cesium.HorizontalOrigin.CENTER, //设置此标签的水平原点
            verticalOrigin: Cesium.VerticalOrigin.BOTTOM, //设置此标签的垂直原点
            pixelOffset: new Cesium.Cartesian2(0, -10), //设置屏幕空间中距此标签远点的像素偏移量
            heightReference: Cesium.HeightReference.CLAMP_TO_GROUND, //设置广告牌的高度参考，固定在地形上
            fillColor: Cesium.Color.WHITE, //颜色
            // eyeOffset: new Cesium.Cartesian3(0, 0, 0),
            // disableDepthTestDistance:10000,//设置与相机的距离，以在该距离处禁用深度测试
            // distanceDisplayCondition:new Cesium.DistanceDisplayCondition(0,20000)//设置多少高度的时候标签可见
          },
        };
        const entity = labelSource.entities.add(opts);
      });
    }
    creatEntity();

    document.getElementById("viewerFlyTo").onclick = function (event) {
      viewer.flyTo(labelSource);
    };

    document.getElementById("CameraFlyTo").onclick = function (event) {
      viewer.camera.flyTo({
        // destination: Cesium.Rectangle.fromDegrees(xmin, ymin, xmax, ymax), //飞到某个矩形
        destination: Cesium.Rectangle.fromDegrees(444656, 77998), //飞到某个点，注意是世界坐标

        //飞完之后设置相机的角度
        // complete: function () {
        //   viewer.scene.camera.setView({
        //     //初始化相机经纬度
        //     destination: new Cesium.Cartesian3.fromDegrees(107.62, 35.9, 5000), //通过最后一个参数可以调节视角高度（初始页面地球大小调节）
        //     orientation: {
        //       heading: Cesium.Math.toRadians(0),
        //       pitch: Cesium.Math.toRadians(-20.0), //从上往下看
        //       roll: 0,
        //     },
        //   });
        // },
      });
    };
  </script>
</html>
